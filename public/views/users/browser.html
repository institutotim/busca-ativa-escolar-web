<div>
	<div class="panel panel-default">
		<div class="panel-heading clearfix">
			<h3 class="pull-left"><i class="fa fa-users"></i> Usuários</h3>
			<a ng-show="identity.can('users.manage')" ui-sref="user_editor({quick_add: quickAdd})" class="btn btn-primary btn-raised pull-right"><i class="fa fa-plus"></i> Novo</a>
		</div>
		<div class="panel-body">

			<form ng-submit="refresh()" name="searchUsers" class="clearfix">
				<div class="row">
					<div class="form-group col-md-6" ng-if="canFilterByTenant">
						<label><i class="fa fa-university"></i> Município</label>
						<ui-select ng-model="query.tenant_id" on-select="refresh()">
							<ui-select-match allow-clear="true" placeholder="Todas">{{$select.selected.name}}</ui-select-match>
							<ui-select-choices repeat="tenant.id as tenant in getTenants() | filter: $select.search track by tenant.id">
								<div ng-bind="tenant.name | highlight: $select.search"></div>
							</ui-select-choices>
						</ui-select>
					</div>

					<div class="form-group col-md-6" ng-if="!canFilterByTenant">
						<label><i class="fa fa-users"></i> Grupo</label>
						<ui-select ng-model="query.group_id" on-select="refresh()">
							<ui-select-match allow-clear="true" placeholder="Todas">{{$select.selected.name}}</ui-select-match>
							<ui-select-choices repeat="group.id as group in getGroups()
							 | filter: $select.search track by group.id">
								<div ng-bind-html="group.name | highlight: $select.search"></div>
							</ui-select-choices>
						</ui-select>
					</div>

					<div class="form-group col-md-6">
						<label><i class="fa fa-user"></i> Tipo</label>
						<ui-select ng-model="query.type" on-select="refresh()">
							<ui-select-match allow-clear="true" placeholder="Todas">{{$select.selected | lang:'user.type'}}</ui-select-match>
							<ui-select-choices repeat="type in static.getUserTypes() | filter: $select.search">
								<div ng-bind-html="type | lang:'user.type' | highlight: $select.search"></div>
							</ui-select-choices>
						</ui-select>
					</div>

				</div>

				<div class="row">
					<div class="form-group col-md-6">
						<label><i class="fa fa-envelope"></i> E-mail</label>
						<div class="clearfix">
							<input type="search" ng-model="query.email" class="form-control" placeholder="Buscar por e-mail" style="width: calc(100% - 60px); float: left;" />
							<button type="submit" class="btn btn-sm btn-raised" style="margin-left: 8px; padding: 8px 16px;"><i class="fa fa-search"></i></button>
						</div>
					</div>
					<div class="form-group col-md-6">
						<label><i class="fa fa-list-ol"></i> Limite de exibição</label>
						<div class="clearfix" style="margin-top: 10px;">
							<ul class="nav nav-pills adm-max-results-filter">
								<li ng-class="{active: query.max==16}"><a ng-click="setMaxResults(16)">16</a></li>
								<li ng-class="{active: query.max==32}"><a ng-click="setMaxResults(32)">32</a></li>
								<li ng-class="{active: query.max==64}"><a ng-click="setMaxResults(64)">64</a></li>
								<li ng-class="{active: query.max==128}"><a ng-click="setMaxResults(128)">128</a></li>
							</ul><br />
						</div>
						<p ng-show="users.length > 0">Total de registros: {{total}}</p>
					</div>
				</div>
			</form>

			<table class="table table-striped table-hover">
				<thead>
					<tr>
						<th>Nome</th>
						<th>Município</th>
						<th>E-mail</th>
						<th>Tipo</th>
						<th>Grupo</th>
						<th ng-show="identity.can('users.manage')">Opções</th>
					</tr>
				</thead>
				<tbody>
					<tr ng-repeat="(i, user) in search.data" class="{{!!user.deleted_at ? 'is-suspended' : ''}}">
						<td width="25%">
							<strong><i class="fa fa-user"></i> {{user.name}}</strong><br />
							<span ng-show="!user.deleted_at" class="label label-success">Ativo</span>
							<span ng-show="!!user.deleted_at" class="label label-warning">Desativado</span>
						</td>
						<td width="18%"><span ng-show="user.tenant">{{user.tenant.name}}</span></td>
						<td width="18%">{{user.email}}</td>
						<td width="18%">{{user.type | lang:'user.type'}}</td>
						<td width="21%">{{user.group.name}}</td>
						<td width="20%" ng-show="identity.can('users.manage')">
							<a ui-sref="user_editor({user_id: user.id, quick_add: quickAdd})" ng-show="identity.can('users.manage')" class="btn btn-info btn-xs" style="margin: 0;"><i class="fa fa-pencil-square-o"></i> Editar</a>
							<a ng-click="suspendUser(user)" ng-show="!user.deleted_at && identity.can('users.manage') && identity.getCurrentUserID() != user.id" class="btn btn-info btn-xs" style="margin: 0;"><i class="fa fa-ban"></i> Desativar</a>
							<a ng-click="restoreUser(user)" ng-show="user.deleted_at && identity.can('users.manage') && identity.getCurrentUserID() != user.id" class="btn btn-info btn-xs" style="margin: 0;"><i class="fa fa-check"></i> Ativar</a>
						</td>
					</tr>
				</tbody>
			</table>

		</div>
	</div>
</div>